<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Load Avarage Chart</title>

		<link href="css/layout.css" rel="stylesheet" type="text/css">
		<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]-->
		<script language="javascript" type="text/javascript" src="js/jquery.min.js"></script>
		<script language="javascript" type="text/javascript" src="js/jquery.flot.js"></script>
	</head>
	<body>
		<h1>Itt lesz egy jรณ chart</h1>
		<div id="placeholder" style="height:300px;"></div>

		<script type="text/javascript">
			var dataArray = [];
			var numArrayLength = 25;
			var numRandomVal = 1;
			var startTMPVal = 1800;
			var placeholder = $("#placeholder");
			var options = {
				lines: { show: true },
				points: { show: true },
				xaxis: { tickDecimals: 0, tickSize: 1 }
			};

			$(document).ready(function () {
				$.plot(placeholder, dataArray, options);

				setInterval(function(){
					if (Math.random()*5 > 3 || numRandomVal <= 0 ) {
						if (Math.random()*2 > 1)
							numRandomVal += 0.2;
					} else {
						numRandomVal -= 0.2;
					}

					if (numRandomVal < 0)
						numRandomVal = 0;

					updateChart(numRandomVal, dataArray)
				},500)
			});

			function rebuildChart(series) {
				data = [ series ];

				$.plot($("#placeholder"), data, options);
			}

			function updateChart (value, dataArray) {

				if (dataArray == undefined) {
					var dataArray = [];
				}

				if (value != undefined) {
					tmp = [startTMPVal++, value];

					dataArray.push(tmp);

					if (dataArray.length >= numArrayLength) {
						delete dataArray[dataArray.length - numArrayLength]
					}

					if (jsonObj == undefined) {
						var jsonObj = {
							"label": "Load AVG",
						    "data": dataArray
						};
					} else {
						jsonObj = {
							"label": "Load AVG",
						    "data": dataArray
						};
					}

					rebuildChart(jsonObj);
				}
			}
		</script>
	</body>
</html>